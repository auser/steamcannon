#!/usr/bin/env ruby

require 'rubygems'
require 'lib/steamcannon/client'

#api_url = 'http://localhost:8080/api'
#api_name = 'lanceball@gmail.com'
#api_pass = 'redacted'

puts "What's your API endpoint URL? (e.g. http://localhost:8080/api)"
api_url  = gets.chomp

puts "What's your steamcannon username?"
api_name = gets.chomp

puts "What's your steamcannon password?"
api_pass = gets.chomp

client = SteamCannon::API::Client.new(api_url, api_name, api_pass)

puts "Environments"
client.environments.each do |environment|
  puts environment.name
  puts "\towner: #{environment.owner}"
  puts "\tcurrent_state: #{environment.current_state}"
  puts "\thref: #{environment.href}"
  puts "\tdeltacloud endpoint: #{environment.deltacloud_url}"
  puts "\tDeployments"
  environment.deployments.each do |deployment|
    puts "\t\tname: #{deployment.name}"
    puts "\t\thref: #{deployment.href}"
    puts "\t\tstatus: #{deployment.current_state}"
  end
end
